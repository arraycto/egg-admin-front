{"version":3,"file":"js/30.js","sources":["webpack:///./src/components/d2-upload/index.vue?115c","webpack:///./src/components/d2-upload/index.vue?42e0","webpack:///./src/api/sys/upload.js","webpack:///./src/components/d2-upload/index.vue","webpack:///./src/components/d2-upload/index.vue?6bab","webpack:///./src/components/d2-upload/index.vue?a8db"],"sourcesContent":["import \"core-js/modules/es.array.for-each\";\nimport \"core-js/modules/es.array.includes\";\nimport \"core-js/modules/es.array.join\";\nimport \"core-js/modules/es.array.map\";\nimport \"core-js/modules/es.number.constructor\";\nimport \"core-js/modules/es.string.includes\";\nimport \"core-js/modules/web.dom-collections.for-each\";\nimport _objectSpread from \"/github/workspace/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getList, remove } from \"@/api/sys/upload\";\nexport default {\n  name: \"d2-upload\",\n  props: {\n    value: {\n      type: String,\n      default: \"\"\n    },\n    accept: String,\n    disabled: Boolean,\n    drag: Boolean,\n    limit: Number,\n    listType: String,\n    multiple: Boolean,\n    showFileList: Boolean\n  },\n  data: function data() {\n    return {\n      action: \"/api/upload\",\n      headers: {\n        Authorization: \"Bearer \" + this.$util.cookies.get(\"token\") || \"\"\n      },\n      fileList: []\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    if (!this.value) return;\n    getList({\n      id: this.value\n    }).then(function (res) {\n      _this.fileList = res.data.map(function (item) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          name: item.filename\n        });\n      });\n    });\n  },\n  methods: {\n    handleSuccess: function handleSuccess(res, file, fileList) {\n      this.fileList = fileList.map(function (item) {\n        return _objectSpread(_objectSpread({}, item), item.response && item.response.data ? item.response.data : {});\n      });\n      var value = this.fileList.map(function (item) {\n        return item._id;\n      }).join(\",\");\n      this.$emit(\"input\", value);\n      this.$emit(\"success\", res, file, this.fileList);\n      this.$emit(\"change\", this.fileList);\n    },\n    handleError: function handleError(err) {\n      console.error(err);\n      this.$message.error(\"上传失败\");\n      this.$emit(\"error\");\n    },\n    handleExceed: function handleExceed() {\n      this.$message.warning(\"超出文件上传数量限制\");\n    },\n    handleBeforeRemove: function handleBeforeRemove(file) {\n      return this.$confirm(\"确认删除文件?\", \"提示\", {\n        type: \"warning\"\n      }).then(function () {\n        return remove(file._id);\n      });\n    },\n    handleRemove: function handleRemove(file, fileList) {\n      this.fileList = fileList;\n      var value = this.fileList.map(function (item) {\n        return item._id;\n      }).join(\",\");\n      this.$emit(\"input\", value);\n      this.$emit(\"remove\", file, fileList);\n      this.$emit(\"change\", fileList);\n    },\n    handlePreview: function handlePreview(file) {\n      if (file.mime.includes(\"image\")) {\n        var index = 0;\n        this.fileList.forEach(function (item, i) {\n          if (item.uid === file.uid) {\n            index = i;\n          }\n        });\n        this.$ImagePreview(this.fileList, index);\n      } else {\n        window.open(file.url, \"_blank\");\n      }\n    }\n  }\n};","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"el-upload\",\n    {\n      attrs: {\n        accept: _vm.accept,\n        action: _vm.action,\n        disabled: _vm.disabled,\n        drag: _vm.drag,\n        \"file-list\": _vm.fileList,\n        headers: _vm.headers,\n        limit: _vm.limit,\n        \"list-type\": _vm.listType,\n        multiple: _vm.multiple,\n        \"show-file-list\": _vm.showFileList,\n        \"before-remove\": _vm.handleBeforeRemove,\n        \"on-exceed\": _vm.handleExceed,\n        \"on-error\": _vm.handleError,\n        \"on-preview\": _vm.handlePreview,\n        \"on-remove\": _vm.handleRemove,\n        \"on-success\": _vm.handleSuccess\n      }\n    },\n    [\n      !_vm.$slots.default\n        ? [\n            _vm.listType === \"picture-card\"\n              ? _c(\"i\", { staticClass: \"el-icon-plus\" })\n              : _c(\"el-button\", { attrs: { size: \"small\", type: \"primary\" } }, [\n                  _vm._v(\"点击上传\")\n                ])\n          ]\n        : _vm._e(),\n      _vm._t(\"default\")\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import request from \"@/libs/axios\"; // 获取列表\n\nexport function getList(params) {\n  return request({\n    url: \"/upload\",\n    params: params\n  });\n} // 获取单条信息\n\nexport function getInfo(id) {\n  return request({\n    url: \"/upload/\" + id\n  });\n} // 新增\n\nexport function uploadFile(data) {\n  return request({\n    url: \"/upload\",\n    method: \"post\",\n    data: data\n  });\n} // 新增\n\nexport function uploadFiles(data) {\n  return request({\n    url: \"/uploads\",\n    method: \"post\",\n    data: data\n  });\n} // 修改\n\nexport function update(id, data) {\n  return request({\n    url: \"/upload/\" + id,\n    method: \"put\",\n    data: data\n  });\n} // 删除\n\nexport function remove(id) {\n  return request({\n    url: \"/upload/\" + id,\n    method: \"delete\"\n  });\n}","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=6df95703&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6df95703\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/github/workspace/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('6df95703')) {\n      api.createRecord('6df95703', component.options)\n    } else {\n      api.reload('6df95703', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=6df95703&scoped=true&\", function () {\n      api.rerender('6df95703', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/components/d2-upload/index.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"4f7348be-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=template&id=6df95703&scoped=true&\""],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC5HA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC5CA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAiBA;AACA;AACA;;;;;;;;;;;;ACtCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}